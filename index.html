<!DOCTYPE html>
<html>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <head>
        <title>Google Slides Wrapper</title>
        <style>
            html, body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
            }
            #google-slides {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border: none;
            }
        </style>
    </head>
    <script>
        let url = 'https://docs.google.com/presentation/d/e/2PACX-1vSb_oW5yruKf9dvUyIBOvzJ0gV4X9dhSnYgP12kHB1_QCDNKpK1-hVv7AV3wsiL9CpMGRt4X1xS2DCx/pubembed?start=true&loop=true';
        let refreshInterval = 10000;
        let delayms = 300;
        function resizeIframeToContent(iframe) {
            console.log('resizeIframeToContent');
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            iframe.style.overflow = 'hidden';
            iframe.style.position = 'absolute';
            iframe.style.top = '0';
            iframe.style.left = '0';
            iframe.style.right = '0';
            iframe.style.bottom = '0';
            iframe.src = url + '&delayms=' + delayms;
        }
        function refreshIframe() {
            console.log('refreshIframe');
            let iframe = document.getElementById('google-slides');
            iframe.src = url + '&delayms=' + delayms;
        }
        setInterval(refreshIframe, refreshInterval);
    </script>
    <body>
        <iframe id="google-slides" src="https://docs.google.com/presentation/d/e/2PACX-1vSb_oW5yruKf9dvUyIBOvzJ0gV4X9dhSnYgP12kHB1_QCDNKpK1-hVv7AV3wsiL9CpMGRt4X1xS2DCx/pubembed?start=true&loop=true&delayms=3000" 
        frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
    </body>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const paramsString = window.location.search;
            const searchParams = new URLSearchParams(paramsString);
            console.log(searchParams.get("url"));
            console.log(searchParams.get("refreshInterval"));
            console.log(searchParams.get("delayms"));
            let turl = searchParams.get("url");
            if (turl) {
                url = turl;
            }
            let trefreshInterval = searchParams.get("refreshInterval");
            if (trefreshInterval) {
                refreshInterval = parseInt(trefreshInterval);
            }
            let tdelayms = searchParams.get("delayms");
            if (tdelayms) {
                delayms = parseInt(tdelayms);
            }
            console.log('DOMContentLoaded');
            resizeIframeToContent(document.getElementById('google-slides'));
        });
    </script>
</html>
